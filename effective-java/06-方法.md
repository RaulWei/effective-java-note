# 06-方法

---

- [第38条：检查参数的有效性](#第38条检查参数的有效性)
- [第39条：必要时进行保护性拷贝](#第39条必要时进行保护性拷贝)
- [第40条：谨慎设计方法签名](#第40条谨慎设计方法签名)

---

## 第38条：检查参数的有效性

编写**方法**或者**构造器**的时候，应该考虑它的参数有哪些限制，把限制写到**文档**中，并在方法**开头**检查参数有效性，否则检测错误可能性小，即使检测到，也难以确定错误根源！

* 公有方法使用**显示检查**实施限制
* 非公有方法使用**断言**，如果断言失败会抛`AssertionError`

## 第39条：必要时进行保护性拷贝

如果类具有**从客户端得到**或者**返回客户端**的**可变**组件，类就必须保护性地拷贝这些组件！
1. 构造器：对每个可变参数进行保护性拷贝是必要的，对于参数类型可以被不可信任方子类化的参数，请**不要**使用`clone`方法进行保护性拷贝
2. 访问方法：返回可变内部域的保护性拷贝，**可以**用`clone`，因为内部域类型我们可以限定它不是不可信任方子类化的

**启发**是只要有可能，都应该使用**不可变**的对象作为对象内部组件，例如，存时间时不存`java.util.Date`，它是可变对象，而是存`Date.getTime()`，它返回`long`基本类型，不可变！

如果拷贝的成本受限制，并且类**信任**它的客户端**不会**不恰当地修改组件，就可以在**文档**中指明客户端的职责是不得修改受到影响的组件，以此来代替保护性拷贝！

## 第40条：谨慎设计方法签名

1. 谨慎地选择方法名称
2. 不要过于追求提供遍历的方法，每个方法应该尽其所能，方法太多使类难以学习、使用、文档化、测试和维护
3. **避免过长**的参数列表，目标是小于等于4个，相同类型的长参数序列各位有害，因为不小心弄错参数顺序仍然可以编译运行，难排错

缩短过长的参数列表的方法
1. 把方法**分解**成多个方法，每个方法只需要这些参数的一个子集，不小心方法可能过多，但可通过提升正交性减少方法数
2. 创建**辅助类**，辅助类一般为静态成员类，参数列表升级为辅助类实例参数
3. 从对象构建到方法调用都采用`Builder`模式

注意，对于`boolean`参数，优先使用两个元素的枚举类型！
```Java
public enum TemperatureScale { FAHRENHEIT, CELSIUS }

// Thermometer.newInstance(TemperatureScale.CELSIUS)比Thermometer.newInstance(true)好多了
```